<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CampusCart - Digital Marketplace for Students</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="logo">
                <h1>Campus<span>Cart</span></h1>
            </div>
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="vendors.html">Vendors</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li class="auth-buttons">
  <a href="#" class="btn-login">Login</a>
  <a href="#" class="btn-signup">Sign Up</a>
</li>
<li class="user-dropdown" style="display: none;">
  <div class="user-icon">
    <i class="fas fa-user-circle"></i>
    <span id="userNameNav"></span>
    <ul class="dropdown-menu">
      <li><a href="#" id="openCustomerProfile">My Profile</a></li>
      <li><a href="#" id="navLogoutBtn">Logout</a></li>
    </ul>
  </div>
</li>
            </ul>
        </div>
    </nav>

    <section class="hero" id="home">
        <div class="container">
            <div class="hero-content">
                <h1>Your one-stop Campus Marketplace for students and businesses.</h1>
                <p>Connect with beauty professionals, businesses, and student entrepreneursâ€”all in one place.</p>
                <div class="hero-buttons">
                    <a href="#" class="btn-primary" id="showSignupModal">Get Started</a>
                    <a href="vendors.html" class="btn-secondary">Explore Vendors</a>
                </div>
            </div>
            <div class="hero-image">
                <img src="images/campuscart logo.jpg" alt="Bowen University Marketplace">
            </div>
        </div>
    </section>
    
    <section class="features">
        <div class="container">
            <div class="section-header">
                <h2>What We Offer</h2>
                <p>Everything you need in one place</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <h3>Local Businesses</h3>
                    <p>Shop from student-run businesses right on campus</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h3>Beauty Appointments</h3>
                    <p>Book services with talented beauty professionals</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <h3>Secure Platform</h3>
                    <p>Safe and trusted community marketplace</p>
                </div>
            </div>
        </div>
    </section>

    <section class="cta">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to Join CampusCart?</h2>
                <p>Sign up today and start connecting with vendors or register your business.</p>
                <div class="cta-buttons">
                    <a href="#" class="btn-primary" id="showSignupModalCta">Sign Up Now</a>
                    <a href="about.html" class="btn-outline">Learn More</a>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2>Campus<span>Cart</span></h2>
                    <p>Your campus marketplace</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h3>Quick Links</h3>
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="about.html">About</a></li>
                            <li><a href="vendors.html">Vendors</a></li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>For Vendors</h3>
                    </div>
                    <div class="footer-column">
                        <h3>For Customers</h3>
                        <ul>
                            <li><a href="vendors.html">Find Services</a></li>
                            <li><a href="faqs.html">FAQs</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 CampusCart. All rights reserved.</p>
                <div class="footer-policies">
                    <a href="privacy-policy.html">Privacy Policy</a>
                    <a href="termsofservice.html">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

  <div class="modal" id="loginModal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Login to CampusCart</h2>
        <form id="loginForm">
            <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" placeholder="Your email" required>
            </div>
            <div class="form-group">
                <label for="loginPassword">Password</label>
                <div class="password-field">
                    <input type="password" id="loginPassword" placeholder="Your password" required>
                    <i class="fas fa-eye toggle-password"></i>
                </div>
            </div>

            <div class="form-group">
                <label for="userRole">Login as</label>
                <select id="userRole" required>
                    <option value="">Select role</option>
                    <option value="vendor">Vendor</option>
                    <option value="customer">Customer</option>
                </select>
            </div>

            <div class="form-options">
                <div class="remember-me">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">Remember me</label>
                </div>
                <a href="#" class="forgot-password">Forgot Password?</a>
            </div>
            <button type="submit" class="btn-primary btn-block">Login</button>
        </form>
        <div class="modal-footer">
            <p>Don't have an account? <a href="#" id="showSignupModalFromLogin">Sign Up</a></p>
        </div>
    </div>
</div>
<div class="modal" id="forgotPasswordModal" style="display:none;">
  <div class="modal-content">
    <span class="close-modal" onclick="document.getElementById('forgotPasswordModal').style.display='none'">&times;</span>
    <h2>Forgot Password</h2>
    <p>Enter your registered email address</p>
    <input type="email" id="resetEmail" placeholder="Enter email" required>
    <button id="sendOtpBtn" onclick="sendOtp()">Send OTP</button>
    <p id="forgotError" style="color:red;"></p>
  </div>
</div>


    <div class="modal" id="signupModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Create an Account</h2>
            <div class="user-type-selector">
                <div class="user-type active" data-type="customer">
                    <i class="fas fa-user"></i>
                    <span>Customer</span>
                </div>
                <div class="user-type" data-type="vendor">
                    <i class="fas fa-store"></i>
                    <span>Vendor</span>
                </div>
            </div>
            <form id="signupForm">
                <div class="form-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" placeholder="Your full name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" placeholder="Your email" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPhone">Phone Number</label>
                        <input type="tel" id="signupPhone" placeholder="Your phone number" required>
                    </div>
                </div>
                <div class="form-group vendor-field" style="display: none;">
                    <label for="businessName">Business Name</label>
                    <input type="text" id="businessName" placeholder="Your business name">
                </div>
                <div class="form-group vendor-field" style="display: none;">
                    <label for="businessType">Business Type</label>
                    <select id="businessType">
                        <option value="">Select business type</option>
                        <option value="beauty">Beauty Professional</option>
                        <option value="Local products">Local Products</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <div class="password-field">
                            <input type="password" id="signupPassword" placeholder="Create password" required>
                            <i class="fas fa-eye toggle-password"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password</label>
                        <div class="password-field">
                            <input type="password" id="confirmPassword" placeholder="Confirm password" required>
                            <i class="fas fa-eye toggle-password"></i>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="terms-checkbox">
                        <input type="checkbox" id="agreeTerms" required>
                        <label for="agreeTerms">I agree to the <a href="#">Terms of Service</a> and <a href="privacy-policy.html">Privacy Policy</a></label>
                    </div>
                </div>
                <button type="submit" class="btn-primary btn-block">Create Account</button>
            </form>
            <div class="modal-footer">
                <p>Already have an account? <a href="#" id="showLoginModalFromSignup">Login</a></p>
            </div>
        </div>
    </div>


    <div class="modal" id="otpModal" style="display: none;">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Verify Your Email</h2>
        <p>We've sent a verification code to your email. Please enter the code below.</p>
        <form id="otpForm">
          <div class="otp-inputs">
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
          </div>
          <div class="resend-otp">
            <p>Didn't receive the code? <a href="#" id="resendOtp">Resend</a></p>
            <div id="otpTimer">00:59</div>
          </div>
          <button type="submit" class="btn-primary btn-block">Verify</button>
        </form>
      </div>
    </div>
<div class="modal" id="customerProfileModal">
  <div class="modal-content">
    <span class="close-modal" onclick="document.getElementById('customerProfileModal').style.display='none'">&times;</span>
    

    <div id="profileView">
      <h2>My Profile</h2>
      <p><strong>Name:</strong> <span id="viewProfileName"></span></p>
      <p><strong>Email:</strong> <span id="viewProfileEmail"></span></p>
      <p><strong>Phone:</strong> <span id="viewProfilePhone"></span></p>
      <button class="btn-primary" id="editProfileBtn">Edit Profile</button>
    </div>

    <form id="editProfileForm" style="display: none;">
      <h2>Edit Profile</h2>
      <div class="form-group">
        <label for="profileName">Full Name</label>
        <input type="text" id="profileName" required>
      </div>
      <div class="form-group">
        <label for="profileEmail">Email (read-only)</label>
        <input type="email" id="profileEmail" readonly>
      </div>
      <div class="form-group">
        <label for="profilePhone">Phone Number</label>
        <input type="tel" id="profilePhone" required>
      </div>
      <div class="form-buttons">
        <button type="submit" class="btn-primary">Save Changes</button>
        <button type="button" class="btn-secondary" id="cancelEditBtn">Cancel</button>
      </div>
    </form>
  </div>
</div>
    <div class="modal" id="otpVerificationModal" style="display:none;">
  <div class="modal-content">
    <span class="close-modal" onclick="document.getElementById('otpVerificationModal').style.display='none'">&times;</span>
    <h2>Verify OTP</h2>
    <p>Enter the 6-digit code sent to your email</p>
    <input type="text" id="enteredOtp" placeholder="Enter OTP" maxlength="6">
    <button onclick="verifyOtp()">Verify</button>
    <p id="otpError" style="color:red;"></p>
  </div>
</div>
</body>

<div class="modal" id="resetPasswordModal" style="display:none;">
  <div class="modal-content">
    <span class="close-modal" onclick="document.getElementById('resetPasswordModal').style.display='none'">&times;</span>
    <h2>Reset Password</h2>
    <input type="password" id="newPassword" placeholder="New password">
    <input type="password" id="confirmNewPassword" placeholder="Confirm password">
    <button onclick="resetPassword()">Reset</button>
    <p id="resetError" style="color:red;"></p>
  </div>
</div>
    <script>
document.getElementById("signupForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const role = document.querySelector(".user-type.active").dataset.type;

    const name = document.getElementById("signupName").value.trim();
    const email = document.getElementById("signupEmail").value.trim();
    const password = document.getElementById("signupPassword").value;
    const confirm = document.getElementById("confirmPassword").value;
    const phone = document.getElementById("signupPhone").value;
    const businessName = document.getElementById("businessName").value.trim();
    const businessType = document.getElementById("businessType").value;

    if (password !== confirm) {
        alert("Passwords do not match.");
        return;
    }

    let payload;
    let apiRoute;

    if(role === "customer"){
        apiRoute = "auth/signup/customer"
        payload = {
            full_name: name,
            email: email,
            phone_number: phone,
            role: role,
            password: password,
            confirm_password: confirm
        }
    }
    else{
        apiRoute = "authsignup/vendor"
        payload = {
            full_name: name,
            email: email,
            phone_number: phone,
            role: role,
            password: password,
            confirm_password: confirm,
            business_name: businessName,
            business_type: businessType
        }
    }

    const response = await fetch("https://e-commerce-4sit.onrender.com/api/v1/" + apiRoute, {
        headers:{
            "Content-Type": "application/json"
        },
        method: "POST",
        body: JSON.stringify(payload)
    })

    if(response.ok) alert("Signup successful!");
    else{
        const data = await response.json()
        alert(data?.detail[0]?.msg)
    }
    
    document.getElementById("signupForm").reset();
    document.getElementById("signupModal").style.display = "none";
});
      
document.getElementById("loginForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const email = document.getElementById("loginEmail").value.trim();
    const password = document.getElementById("loginPassword").value.trim();
    // const role = document.getElementById("userRole").value;

    const payload = {
        email: email,
        password: password
    }

    const response = await fetch("https://e-commerce-4sit.onrender.com/api/v1/auth/login", {
        headers:{
            "Content-Type": "application/json"
        },
        method: "POST",
        body: JSON.stringify(payload)
    })
    const data = await response.json()
    if(response.ok){
        console.log(data)
        const user = {
            role: ""
        }
        // if (currentRole === "customer") {
        // localStorage.setItem("customer", JSON.stringify(data))
        //     showCustomerProfile(currentUsers[currentEmail]); 
        // } else if (currentRole === "vendor") {
        // localStorage.setItem("vendor", JSON.stringify(data))
        //     window.location.href = "vendors-dashboard.html"; 
        // }
    }
    else alert(data?.detail[0]?.msg)
});
document.addEventListener("DOMContentLoaded", function () {
    const user = JSON.parse(localStorage.getItem("user"))






    const userEmail = localStorage.getItem("userEmail");
    const userRole = localStorage.getItem("userRole");
    const users = JSON.parse(localStorage.getItem("users") || "{}");

    const authBtns = document.querySelector(".auth-buttons");
    const userDropdown = document.querySelector(".user-dropdown");
    const userNameNav = document.getElementById("userNameNav");
    const profileBtn = document.getElementById("openCustomerProfile");
    const profileModal = document.getElementById("customerProfileModal");

    if (userEmail && users[userEmail]) {
        authBtns.style.display = "none";
        userDropdown.style.display = "flex";
        userNameNav.textContent = users[userEmail].name.split(" ")[0];
    }
profileBtn.addEventListener("click", function (e) {
    e.preventDefault();

    const currentRole = localStorage.getItem("userRole");
    const currentEmail = localStorage.getItem("userEmail");
    const currentUsers = JSON.parse(localStorage.getItem("users") || "{}");

    if (!currentEmail || !currentUsers[currentEmail]) return;

    if (currentRole === "customer") {
        showCustomerProfile(currentUsers[currentEmail]); 
    } else if (currentRole === "vendor") {
        window.location.href = "vendors-dashboard.html"; 
    } else {
        alert("Unknown user role. Please log in again.");
    }
});
function showCustomerProfile(user) {
    document.getElementById("profileView").style.display = "block";
    document.getElementById("editProfileForm").style.display = "none";
    document.getElementById("viewProfileName").textContent = user.name;
    document.getElementById("viewProfileEmail").textContent = user.email;
    document.getElementById("viewProfilePhone").textContent = user.phone;
    document.getElementById("profileName").value = user.name;
    document.getElementById("profileEmail").value = user.email;
    document.getElementById("profilePhone").value = user.phone;
    document.getElementById("customerProfileModal").style.display = "block";
}

document.getElementById("editProfileBtn").addEventListener("click", function () {
    document.getElementById("profileView").style.display = "none";
    document.getElementById("editProfileForm").style.display = "block";
});

document.getElementById("cancelEditBtn").addEventListener("click", function () {
    document.getElementById("profileView").style.display = "block";
    document.getElementById("editProfileForm").style.display = "none";
});

    document.getElementById("editProfileForm").addEventListener("submit", function (e) {
        e.preventDefault();
        const email = localStorage.getItem("userEmail");
        const users = JSON.parse(localStorage.getItem("users") || "{}");

        if (!users[email]) return;

        users[email].name = document.getElementById("profileName").value;
        users[email].phone = document.getElementById("profilePhone").value;

        localStorage.setItem("users", JSON.stringify(users));
        alert("Profile updated successfully!");
        profileModal.style.display = "none";
    });

    // Logout
    document.getElementById("navLogoutBtn").addEventListener("click", function (e) {
        e.preventDefault();
        localStorage.removeItem("userEmail");
        localStorage.removeItem("userRole");
        location.reload();
    });
    window.onclick = function (event) {
        if (event.target == profileModal) {
            profileModal.style.display = "none";
        }
    };
});

</script>


    <script src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
</body>
</html>