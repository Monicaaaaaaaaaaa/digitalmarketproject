<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vendor Profile</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header class="profile-header">
  <h1 id="vendor-name">Vendor</h1>
  <button id="darkToggle" class="btn-secondary">üåì</button>
</header>

<main class="vendor-profile-container">

  <section class="vendor-details fade-in">
    <img id="vendor-image" src="default-vendor.jpg" alt="Vendor banner"/>
    <p><strong>Email:</strong> <span id="vendor-email"> </span></p>
    <p><strong>Phone:</strong> <span id="vendor-phone"> </span></p>
    <p><strong>Category:</strong> <span id="vendor-category"> </span></p>
    <p><strong>Description:</strong> <span id="vendor-description"> </span></p>
  </section>

<section class="vendor-services fade-in" id="servicesBlock" style="display:none">
  <h3>Services Offered</h3>
  <div id="servicesList" class="services-grid"></div>
</section>

<!-- Booking Trigger Button (shown only for beauty vendors) -->
<section class="fade-in" id="bookingTrigger" style="display: none; margin-top: 30px;">
  <button id="showBookingBtn" class="btn-primary">Book Appointment</button>
</section>

<!-- Booking Form Section (hidden by default) -->
<section class="vendor-booking fade-in" id="bookingSection" style="display: none;">
  <h3>Book an Appointment</h3>
  <form id="bookingForm">
    <label for="appointmentName">Your Name:</label>
    <input type="text" id="appointmentName" required />

    <label for="appointmentDate">Date:</label>
    <input type="date" id="appointmentDate" required />

    <label for="appointmentTime">Time:</label>
    <input type="time" id="appointmentTime" required />

    <label for="appointmentNote">Note (optional):</label>
    <textarea id="appointmentNote" placeholder="Describe the service or any notes..."></textarea>

    <button type="submit" class="btn-primary">Book Now</button>
  </form>
</section>
  <section id="contactFormSection" class="fade-in">
    <h3>Send a Message</h3>
    <form id="contactForm">
      <input type="text"  id="custName"     placeholder="Your name" required>
      <textarea           id="custMessage"  placeholder="Hi, I‚Äôd like to‚Ä¶" rows="4" required></textarea>
      <button class="btn-secondary">Send</button>
    </form>
  </section>

<section class="vendor-rating fade-in">
  <h3>Ratings & Reviews</h3>
  <div class="rating-display" id="average-rating">‚≠ê 0.0</div>
  <div class="review-list" id="review-list"></div>
</section>

<section class="leave-review fade-in">
  <h3>Leave a Review</h3>
  <form id="reviewForm">
    <label for="reviewer">Name:</label>
    <input type="text" id="reviewer" required />
    
    <label for="reviewText">Review:</label>
    <textarea id="reviewText" required></textarea>

    <label>Rating:</label>
    <div class="star-rating" id="starRating">
      <span data-value="1">‚òÖ</span>
      <span data-value="2">‚òÖ</span>
      <span data-value="3">‚òÖ</span>
      <span data-value="4">‚òÖ</span>
      <span data-value="5">‚òÖ</span>
    </div>

    <input type="hidden" id="rating" required />
    <button type="submit" class="btn-primary">Submit Review</button>
  </form>
</section>

</main>
<script>
document.getElementById("darkToggle").onclick = () =>
  document.body.classList.toggle("dark-mode");

document.addEventListener("DOMContentLoaded", () => {
  const qsEmail = new URLSearchParams(location.search).get("email");
  const email = qsEmail || localStorage.getItem("userEmail");
  const el = id => document.getElementById(id);

  if (!email) {
    alert("No vendor specified");
    location.href = "vendors.html";
    return;
  }

  let data = JSON.parse(localStorage.getItem(`vendorData_${email}`));

  //hardcoded vendors
  if (!data) {
    const fallbackProfiles = {
      "glamsquad@example.com": {
        businessName: "Glam Squad",
        phone: "09012345678",
        category: "Beauty Professionals",
        description: "Professional makeup, hair styling, and nail services.",
        imageUrl: "images/placeholder",
        services: [
          { name: "Makeup", image: "images/placeholder", price: "5000" },
          { name: "Hair Styling", image: "images/placeholder", price: "7000" }
        ]
      },
       "campusthreads@example.com": {
        businessName: "Campus Threads",
        phone: "08123456789",
        category: "Fashion",
        description: "Trendy clothing and accessories for students.",
        imageUrl: "images/placeholder",
        services: [
          { name: "Hoodies", image: "images/placeholder", price: "7000" },
          { name: "Jeans", image: "images/placeholder", price: "6000" }
        ]
      },
      "lashes@example.com": {
        businessName: "Lashes Extensions",
        phone: "08099887766",
        category: "Lashes",
        description: "Enhancing your eyelashes with extensions or cluster lashes.",
        imageUrl: "images/placeholder",
        services: [
          { name: "Lash Extensions", image: "images/placeholder", price: "3500" }
        ]
      }
    };
    data = fallbackProfiles[email];
  }

  if (!data) {
    alert("Vendor has not set up a profile.");
    return;
  }
  
  el("vendor-name").textContent = data.businessName || "Vendor";
  el("vendor-email").textContent = email;
  el("vendor-phone").textContent = data.phone || "‚Äî";
  el("vendor-category").textContent = data.category || "‚Äî";
  el("vendor-description").textContent = data.description || "";
  el("vendor-image").src = data.imageUrl || "default-vendor.jpg";

  const vendorId = email;
  localStorage.setItem("currentVendorId", vendorId);

  // Display services with price
  if (Array.isArray(data.services) && data.services.length) {
    const container = document.getElementById("servicesList");
    data.services.forEach(service => {
      const card = document.createElement("div");
      card.className = "service-card";
      card.innerHTML = `
        <img src="${service.image || 'default-service.jpg'}" alt="${service.name}">
        <div class="service-info">
          <p>${service.name}</p>
          <strong>‚Ç¶${service.price || "‚Äî"}</strong>
        </div>
      `;
      container.appendChild(card);
    });
    document.getElementById("servicesBlock").style.display = "block";
  }

  // Show booking section if beauty-related
  const category = (data.category || "").toLowerCase();
  const bookingTrigger = document.getElementById("bookingTrigger");
  const bookingSection = document.getElementById("bookingSection");

  if (
    category.includes("beauty") ||
    category.includes("hair") ||
    category.includes("makeup") ||
    category.includes("nail") ||
    category.includes("lash")
  ) {
    bookingTrigger.style.display = "block";
    document.getElementById("showBookingBtn").addEventListener("click", () => {
      bookingSection.style.display = "block";
      bookingTrigger.style.display = "none";
      bookingSection.scrollIntoView({ behavior: "smooth" });
    });
  }

  // Contact form demo
  document.getElementById("contactForm").addEventListener("submit", e => {
    e.preventDefault();
    alert("Message sent ‚Äì demo only.");
    e.target.reset();
  });

  // Booking form demo
  const bookingForm = document.getElementById("bookingForm");
  bookingForm?.addEventListener("submit", function (e) {
    e.preventDefault();

    const bookingsKey = `vendorBookings_${vendorId}`;
    const existingBookings = JSON.parse(localStorage.getItem(bookingsKey)) || [];

    const newBooking = {
      name: document.getElementById("appointmentName").value.trim(),
      date: document.getElementById("appointmentDate").value,
      time: document.getElementById("appointmentTime").value,
      note: document.getElementById("appointmentNote").value.trim(),
      status: "Pending"
    };

    existingBookings.push(newBooking);
    localStorage.setItem(bookingsKey, JSON.stringify(existingBookings));
    alert("Booking sent! Vendor will confirm shortly.");
    bookingForm.reset();
  });
});
</script>
</body>
</html>

